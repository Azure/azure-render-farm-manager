@model WebApp.Models.Packages.AddPackageModel
@{
    ViewBag.Title = "Add a Package";
}

@section Breadcrumb
    {
    <a asp-controller="Packages" asp-action="Index">Packages</a> &gt;
    <span>New</span>
}

<div class="page-header">
    <h2>Add a new package</h2>
    <p></p>
</div>

<div class="form-element">
    <label>Package Type</label>
    <select id="PackageTypes" name="PackageTypes">
        <option value="qube70" selected>Qube 7.0</option>
        <option value="qube610">Qube 6.10</option>
        <option value="deadline10">Deadline 10</option>
        <option value="tractor2">Tractor 2.x</option>
        <option value="opencue">OpenCue</option>
        <option value="gpu">GPU</option>
        <option value="general">General</option>
    </select>
</div>

<div id="qube70">
    <form asp-controller="Packages" asp-action="AddQube70" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>Qube 7.0 Installer Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. Qube 7.0" value="@Model.PackageName"/>
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.PythonInstaller">Python Installer</label>
                        <input asp-for="QubePackage.PythonInstaller" type="file" accept=".msi,.exe" />
                        <span asp-validation-for="QubePackage.PythonInstaller" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeCoreMsi">Qube Core MSI</label>
                        <input asp-for="QubePackage.QubeCoreMsi" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QubeCoreMsi" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeWorkerMsi">Qube Worker MSI</label>
                        <input asp-for="QubePackage.QubeWorkerMsi" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QubeWorkerMsi" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeJobTypeMsis">Qube Job Type MSIs (e.g. 3ds Max, Maya etc)</label>
                        <input asp-for="QubePackage.QubeJobTypeMsis" type="file" accept=".msi" multiple />
                        <span asp-validation-for="QubePackage.QubeJobTypeMsis" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QbConf">qb.conf (Optional)</label>
                        <input asp-for="QubePackage.QbConf" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QbConf" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="qube610" style="display: none;">
    <form asp-controller="Packages" asp-action="AddQube610" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>Qube 6.10 Installer Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. Qube 6.10"/>
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.PythonInstaller">Python Installer</label>
                        <input asp-for="QubePackage.PythonInstaller" type="file" accept=".msi,.exe" />
                        <span asp-validation-for="QubePackage.PythonInstaller" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeCoreMsi">Qube Core MSI</label>
                        <input asp-for="QubePackage.QubeCoreMsi" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QubeCoreMsi" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeWorkerMsi">Qube Worker MSI</label>
                        <input asp-for="QubePackage.QubeWorkerMsi" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QubeWorkerMsi" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QubeJobTypeMsis">Qube Job Type MSIs (e.g. 3ds Max, Maya etc)</label>
                        <input asp-for="QubePackage.QubeJobTypeMsis" type="file" accept=".msi" multiple />
                        <span asp-validation-for="QubePackage.QubeJobTypeMsis" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="QubePackage.QbConf">qb.conf (Optional)</label>
                        <input asp-for="QubePackage.QbConf" type="file" accept=".msi" />
                        <span asp-validation-for="QubePackage.QbConf" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="deadline10" style="display: none;">
    <form asp-controller="Packages" asp-action="AddDeadline10" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>Deadline 10 Installer Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. Deadline 10.0.12" value="Deadline10" />
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.Files">Deadline Client Installer (.exe)</label>
                        <input asp-for="GeneralPackage.Files" type="file" accept=".exe" />
                        <span asp-validation-for="GeneralPackage.Files" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="tractor2" style="display: none;">
    <form asp-controller="Packages" asp-action="AddTractor2" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>Tractor 2.x Installer Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. Tractor2.3" value="Tractor2.3" />
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.Files">Tractor Installer (e.g. Tractor-2.3_xxx.x86_64.msi or Tractor-2.3_xxx.x86_64.rpm)</label>
                        <input asp-for="GeneralPackage.Files" type="file" accept=".msi,.rpm" />
                        <span asp-validation-for="GeneralPackage.Files" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="opencue" style="display: none;">
    <form asp-controller="Packages" asp-action="AddOpenCue" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>OpenCue RQD Installer Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. OpenCueRQD-0.2.119" value="OpenCueRQD" />
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.Files">RQD Installer (e.g. rqd-0.2.119-all.tar.gz)</label>
                        <input asp-for="GeneralPackage.Files" type="file" accept=".gz" />
                        <span asp-validation-for="GeneralPackage.Files" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="gpu" style="display: none;">
    <form asp-controller="Packages" asp-action="AddGpu" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>GPU Driver Package</h3>
                    <p></p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. NVIDIA 398.75" value="NVIDIA-GPU"/>
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.Files">GPU Driver (.zip)</label>
                        <input asp-for="GeneralPackage.Files" type="file" accept=".zip" />
                        <span asp-validation-for="GeneralPackage.Files" class=""></span>
                        <small>See NVIDIA's web site for the latest GPU driver downloads, or you can download a recent NVIDIA Tesla driver <a href="http://us.download.nvidia.com/Windows/Quadro_Certified/398.75/398.75-tesla-desktop-winserver2016-international.exe">here</a></small>
                        <small>The NVIDIA driver (.exe) must be extracted and zipped prior to upload.  After downloading, double-click the .exe to extract the files.  Once extracted select all the files, right-click -> Send To -> Compressed (zipped) folder.  The NVIDIA driver files should be in the root of the ZIP.</small>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.InstallCommandLine">Installation Command (Optional)</label>
                        <input asp-for="GeneralPackage.InstallCommandLine" placeholder="powershell.exe -Command Expand-Archive -Path *.zip -DestinationPath .; .\setup.exe -s -noreboot" value="powershell.exe -Command Expand-Archive -Path *.zip -DestinationPath .; .\setup.exe -s -noreboot" />
                        <span asp-validation-for="GeneralPackage.InstallCommandLine" class=""></span>
                        <small>The command line to install the GPU drivers.  The default is sufficient if the standard NVIDIA drivers are used.</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

<div id="general" style="display: none;">
    <form asp-controller="Packages" asp-action="AddGeneral" method="post" enctype="multipart/form-data" role="form">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class=""></div>
        <div class="form-section">
            <div class="section-title">
                <span class="step-index">1</span>
                <div class="step-header">
                    <h3>General Package</h3>
                    <p>Specify the package files</p>
                </div>
            </div>
            <div class="section-wrapper">
                <div class="section-bar"></div>
                <div class="section-content">
                    <div class="form-element">
                        <label asp-for="PackageName">Package Name</label>
                        <input asp-for="PackageName" placeholder="e.g. Redshift" />
                        <span asp-validation-for="PackageName" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.Files">Package Files</label>
                        <input asp-for="GeneralPackage.Files" type="file" multiple />
                        <span asp-validation-for="GeneralPackage.Files" class=""></span>
                    </div>
                    <div class="form-element">
                        <label asp-for="GeneralPackage.InstallCommandLine">Installation Command (Optional)</label>
                        <input asp-for="GeneralPackage.InstallCommandLine" placeholder="e.g. msiexec /s redshift.msi" />
                        <span asp-validation-for="GeneralPackage.InstallCommandLine" class=""></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-footer">
            <div class="button-bar">
                <button type="submit">Save Package <i class="fa fa-save"></i></button>
            </div>
        </div>
    </form>
</div>

@section Scripts
{
<script>
    $(document).ready(function () {

        if ('@Model.Type' !== '') {
            var type = '@Model.Type'.toLowerCase();
            $("#PackageTypes").val(type);
        }

        $("#PackageTypes").change(function () {
            // Disable all
            $('#PackageTypes > option').each(function () {
                var sectionToDisable = $(this).val();
                var divId = '#' + sectionToDisable;
                $(divId).hide();
                $(divId + " :input").attr("readonly", "readonly");
                $(divId + " select").attr("disabled", "disabled");
                $(divId + " :input[type='file']").attr("disabled", "disabled");
            });

            var c = $("#PackageTypes option:selected").val();
            var divId = '#' + c;
            console.log(c);

            $(divId + " :input").removeAttr("readonly");
            $(divId + " select").removeAttr("disabled");
            $(divId + " :input[type='file']").removeAttr("disabled");
            $(divId).show();
        });

        $("#PackageTypes").change();
    });

</script>
}
